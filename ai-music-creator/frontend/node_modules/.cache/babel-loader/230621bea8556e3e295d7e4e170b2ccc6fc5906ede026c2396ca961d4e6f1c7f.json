{"ast":null,"code":"var _jsxFileName = \"/Users/ewanmcphilliamy/Documents/SunoLikeAppByCluade/ai-music-creator/frontend/src/App.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from 'react';\nimport { Play, Pause, Upload, Download, Music, Radio, Volume2, Trash2 } from 'lucide-react';\nimport * as Tone from 'tone';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AIMusicsCreator = () => {\n  _s();\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [currentTrack, setCurrentTrack] = useState(null);\n  const [tracks, setTracks] = useState([]);\n  const [projectName, setProjectName] = useState('Untitled Project');\n  const [generationPrompt, setGenerationPrompt] = useState('');\n  const [isGenerating, setIsGenerating] = useState(false);\n  const [selectedGenre, setSelectedGenre] = useState('pop');\n  const [tempo, setTempo] = useState(120);\n  const [key, setKey] = useState('C');\n  const [duration, setDuration] = useState(30);\n  const [generationError, setGenerationError] = useState('');\n  const [connectionError, setConnectionError] = useState('');\n  const [generationProgress, setGenerationProgress] = useState(0);\n  const [currentCommand, setCurrentCommand] = useState('Idle');\n  const [connectionStatus, setConnectionStatus] = useState('Connecting...');\n  const [generationStep, setGenerationStep] = useState('');\n  const [searchTerm, setSearchTerm] = useState('');\n  const [selectedSample, setSelectedSample] = useState(null);\n  const [samplePlaying, setSamplePlaying] = useState(null);\n  const [loadingSamples, setLoadingSamples] = useState(false);\n  const [sampleDatabaseLoaded, setSampleDatabaseLoaded] = useState([]);\n  const [isCheckingConnection, setIsCheckingConnection] = useState(false);\n  const audioElementRef = useRef(null);\n  const sampleAudioRef = useRef(null);\n\n  // Royalty-free music database with actual working URLs\n  const fallbackSamples = [{\n    id: 1,\n    title: \"Acoustic Folk\",\n    artist: \"Kevin MacLeod\",\n    genre: \"folk\",\n    tempo: 120,\n    key: \"C\",\n    mood: \"peaceful\",\n    tags: [\"acoustic\", \"guitar\", \"calm\"],\n    previewUrl: \"https://incompetech.com/music/royalty-free/mp3-royaltyfree/Carefree.mp3\"\n  }, {\n    id: 2,\n    title: \"Electronic Chill\",\n    artist: \"Kevin MacLeod\",\n    genre: \"electronic\",\n    tempo: 128,\n    key: \"G\",\n    mood: \"energetic\",\n    tags: [\"electronic\", \"beat\", \"synth\"],\n    previewUrl: \"https://incompetech.com/music/royalty-free/mp3-royaltyfree/Electrodoodle.mp3\"\n  }, {\n    id: 3,\n    title: \"Jazz Lounge\",\n    artist: \"Kevin MacLeod\",\n    genre: \"jazz\",\n    tempo: 110,\n    key: \"F\",\n    mood: \"sophisticated\",\n    tags: [\"jazz\", \"piano\", \"smooth\"],\n    previewUrl: \"https://incompetech.com/music/royalty-free/mp3-royaltyfree/Heinousity.mp3\"\n  }, {\n    id: 4,\n    title: \"Rock Energy\",\n    artist: \"Kevin MacLeod\",\n    genre: \"rock\",\n    tempo: 140,\n    key: \"E\",\n    mood: \"energetic\",\n    tags: [\"rock\", \"guitar\", \"driving\"],\n    previewUrl: \"https://incompetech.com/music/royalty-free/mp3-royaltyfree/Funky%20Suspense.mp3\"\n  }, {\n    id: 5,\n    title: \"Ambient Space\",\n    artist: \"Kevin MacLeod\",\n    genre: \"ambient\",\n    tempo: 80,\n    key: \"A\",\n    mood: \"dreamy\",\n    tags: [\"ambient\", \"synth\", \"atmospheric\"],\n    previewUrl: \"https://incompetech.com/music/royalty-free/mp3-royaltyfree/Cipher.mp3\"\n  }, {\n    id: 6,\n    title: \"Hip Hop Groove\",\n    artist: \"Kevin MacLeod\",\n    genre: \"hip-hop\",\n    tempo: 95,\n    key: \"D\",\n    mood: \"cool\",\n    tags: [\"hip-hop\", \"beat\", \"urban\"],\n    previewUrl: \"https://incompetech.com/music/royalty-free/mp3-royaltyfree/Sneaky%20Snitch.mp3\"\n  }, {\n    id: 7,\n    title: \"Classical Piano\",\n    artist: \"Kevin MacLeod\",\n    genre: \"classical\",\n    tempo: 70,\n    key: \"C\",\n    mood: \"elegant\",\n    tags: [\"classical\", \"piano\", \"orchestral\"],\n    previewUrl: \"https://incompetech.com/music/royalty-free/mp3-royaltyfree/Deliberate%20Thought.mp3\"\n  }, {\n    id: 8,\n    title: \"Indie Pop\",\n    artist: \"Kevin MacLeod\",\n    genre: \"pop\",\n    tempo: 125,\n    key: \"G\",\n    mood: \"upbeat\",\n    tags: [\"pop\", \"indie\", \"catchy\"],\n    previewUrl: \"https://incompetech.com/music/royalty-free/mp3-royaltyfree/Happy%20Boy%20End%20Theme.mp3\"\n  }, {\n    id: 9,\n    title: \"Country Folk\",\n    artist: \"Kevin MacLeod\",\n    genre: \"country\",\n    tempo: 100,\n    key: \"D\",\n    mood: \"nostalgic\",\n    tags: [\"country\", \"folk\", \"acoustic\"],\n    previewUrl: \"https://incompetech.com/music/royalty-free/mp3-royaltyfree/Danse%20Morialta.mp3\"\n  }, {\n    id: 10,\n    title: \"Blues Guitar\",\n    artist: \"Kevin MacLeod\",\n    genre: \"blues\",\n    tempo: 75,\n    key: \"A\",\n    mood: \"soulful\",\n    tags: [\"blues\", \"guitar\", \"emotional\"],\n    previewUrl: \"https://incompetech.com/music/royalty-free/mp3-royaltyfree/Laid%20Back%20Guitars.mp3\"\n  }];\n\n  // Fetch samples from Free Music Archive API\n  const fetchSamplesFromFMA = async () => {\n    try {\n      setLoadingSamples(true);\n      console.log('🎵 Loading royalty-free music database...');\n\n      // For now, we'll use the curated Kevin MacLeod collection\n      // These are all royalty-free and hosted on Incompetech\n      console.log('✅ Using Kevin MacLeod royalty-free music collection');\n\n      // Simulate loading time for realistic feel\n      await new Promise(resolve => setTimeout(resolve, 1000));\n      return fallbackSamples;\n    } catch (error) {\n      console.warn('Could not load music database, using fallback samples:', error);\n      return fallbackSamples;\n    } finally {\n      setLoadingSamples(false);\n    }\n  };\n\n  // Load samples on component mount\n  useEffect(() => {\n    const loadSamples = async () => {\n      const samples = await fetchSamplesFromFMA();\n      setSampleDatabaseLoaded(samples);\n    };\n    loadSamples();\n  }, []);\n\n  // Use loaded samples or fallback\n  const sampleDatabase = sampleDatabaseLoaded.length > 0 ? sampleDatabaseLoaded : fallbackSamples;\n  const genres = ['pop', 'rock', 'jazz', 'electronic', 'hip-hop', 'classical', 'country', 'blues'];\n  const keys = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];\n\n  // Music theory data\n  const scales = {\n    major: [0, 2, 4, 5, 7, 9, 11],\n    minor: [0, 2, 3, 5, 7, 8, 10],\n    blues: [0, 3, 5, 6, 7, 10],\n    pentatonic: [0, 2, 4, 7, 9]\n  };\n  const chordProgressions = {\n    pop: ['I', 'V', 'vi', 'IV'],\n    rock: ['I', 'bVII', 'IV', 'I'],\n    jazz: ['I', 'vi', 'ii', 'V'],\n    blues: ['I', 'I', 'I', 'I', 'IV', 'IV', 'I', 'I', 'V', 'IV', 'I', 'V']\n  };\n  const filteredSamples = sampleDatabase.filter(sample => sample.title.toLowerCase().includes(searchTerm.toLowerCase()) || sample.artist.toLowerCase().includes(searchTerm.toLowerCase()) || sample.genre.toLowerCase().includes(searchTerm.toLowerCase()) || sample.tags.some(tag => tag.toLowerCase().includes(searchTerm.toLowerCase())));\n  const getScale = (rootNote, scaleType) => {\n    const noteNames = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];\n    const rootIndex = noteNames.indexOf(rootNote);\n    const scale = scales[scaleType] || scales.major;\n    return scale.map(interval => {\n      const noteIndex = (rootIndex + interval) % 12;\n      return noteNames[noteIndex];\n    });\n  };\n  const generateMelody = (scaleNotes, length = 16) => {\n    const melody = [];\n    for (let i = 0; i < length; i++) {\n      if (Math.random() > 0.2) {\n        // 80% chance to play a note\n        const noteIndex = Math.floor(Math.random() * scaleNotes.length);\n        const octave = 4 + Math.floor(Math.random() * 2); // Octave 4 or 5\n        melody.push({\n          note: scaleNotes[noteIndex],\n          octave: octave,\n          time: i * 0.25 // 16th notes\n        });\n      } else {\n        melody.push(null);\n      }\n    }\n    return melody;\n  };\n  const generateChords = (rootNote, progression) => {\n    const noteNames = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];\n    const rootIndex = noteNames.indexOf(rootNote);\n    const scale = getScale(rootNote, 'major');\n    return progression.map(chord => {\n      let chordRoot;\n      switch (chord) {\n        case 'I':\n          chordRoot = scale[0];\n          break;\n        case 'ii':\n          chordRoot = scale[1];\n          break;\n        case 'iii':\n          chordRoot = scale[2];\n          break;\n        case 'IV':\n          chordRoot = scale[3];\n          break;\n        case 'V':\n          chordRoot = scale[4];\n          break;\n        case 'vi':\n          chordRoot = scale[5];\n          break;\n        case 'bVII':\n          chordRoot = noteNames[(rootIndex + 10) % 12];\n          break;\n        default:\n          chordRoot = scale[0];\n      }\n\n      // Generate triad - ensure we always return a valid array\n      const chordScale = getScale(chordRoot, 'major');\n      return [chordScale[0] || 'C', chordScale[2] || 'E', chordScale[4] || 'G']; // Root, third, fifth with fallbacks\n    }).filter(chord => chord && chord.length === 3); // Filter out any invalid chords\n  };\n\n  // Check backend connection\n  const checkBackendConnection = async () => {\n    try {\n      setIsCheckingConnection(true);\n      setCurrentCommand('Checking backend connection...');\n      setConnectionStatus('🔄 Connecting...');\n      setConnectionError(''); // Clear any previous errors\n\n      // Actually test the backend connection\n      const response = await fetch('http://localhost:3001/api/health', {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        signal: AbortSignal.timeout(5000) // 5 second timeout\n      });\n      if (response.ok) {\n        const data = await response.json();\n        setConnectionStatus('✅ Connected to Backend');\n        setCurrentCommand('Backend online - ready for generation');\n        console.log('✅ Backend connection successful:', data);\n      } else {\n        throw new Error(`Backend returned ${response.status}: ${response.statusText}`);\n      }\n    } catch (error) {\n      console.error('❌ Backend connection failed:', error);\n      setConnectionStatus('❌ Backend Offline');\n      if (error instanceof Error) {\n        if (error.name === 'TimeoutError') {\n          setConnectionError('Backend connection timeout. Is the server running on port 3001?');\n        } else if (error.message.includes('fetch')) {\n          setConnectionError('Cannot reach backend server. Please start the backend on port 3001.');\n        } else {\n          setConnectionError(`Backend error: ${error.message}`);\n        }\n      } else {\n        setConnectionError('Unknown backend connection error.');\n      }\n      setCurrentCommand('Backend offline - using local generation only');\n    } finally {\n      setIsCheckingConnection(false);\n    }\n  };\n\n  // Check backend connection on mount\n  useEffect(() => {\n    checkBackendConnection();\n  }, []);\n  const interpretPromptWithLLM = async prompt => {\n    try {\n      setCurrentCommand('🧠 AI analyzing prompt...');\n\n      // Call backend LLM service\n      const response = await fetch('http://localhost:3001/api/interpret-prompt', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          prompt: prompt,\n          availableGenres: genres,\n          availableKeys: keys,\n          currentGenre: selectedGenre,\n          currentTempo: tempo,\n          currentKey: key\n        })\n      });\n      if (response.ok) {\n        const interpretation = await response.json();\n        console.log('🎯 LLM interpretation:', interpretation);\n        return interpretation;\n      } else {\n        throw new Error('LLM service unavailable');\n      }\n    } catch (error) {\n      console.log('🔄 LLM unavailable, using enhanced keyword matching');\n\n      // Enhanced fallback with better keyword detection\n      const lowerPrompt = prompt.toLowerCase();\n      let inferredGenre = selectedGenre;\n      let inferredTempo = tempo;\n      let inferredKey = key;\n      let mood = 'neutral';\n      let instruments = ['synth'];\n      let complexity = 'medium';\n      let energy = 'medium';\n\n      // Advanced genre detection\n      const genreKeywords = {\n        rock: ['rock', 'guitar', 'heavy', 'metal', 'grunge', 'punk', 'alternative'],\n        jazz: ['jazz', 'swing', 'saxophone', 'trumpet', 'bebop', 'smooth', 'improvisation'],\n        electronic: ['electronic', 'edm', 'techno', 'house', 'trance', 'dubstep', 'synth', 'digital'],\n        blues: ['blues', 'mississippi', 'chicago', 'delta', 'harmonica', 'slide guitar'],\n        pop: ['pop', 'catchy', 'radio', 'mainstream', 'chart', 'commercial', 'vocals'],\n        classical: ['classical', 'orchestra', 'symphony', 'piano', 'violin', 'baroque', 'romantic'],\n        'hip-hop': ['hip hop', 'rap', 'urban', 'beats', 'sampling', 'mc', 'breakbeat'],\n        country: ['country', 'western', 'nashville', 'banjo', 'fiddle', 'honky tonk']\n      };\n\n      // Find best matching genre\n      let maxMatches = 0;\n      Object.entries(genreKeywords).forEach(([genre, keywords]) => {\n        const matches = keywords.filter(keyword => lowerPrompt.includes(keyword)).length;\n        if (matches > maxMatches) {\n          maxMatches = matches;\n          inferredGenre = genre;\n        }\n      });\n\n      // Tempo and energy detection\n      if (lowerPrompt.includes('fast') || lowerPrompt.includes('upbeat') || lowerPrompt.includes('energetic') || lowerPrompt.includes('driving')) {\n        inferredTempo = Math.max(inferredTempo + 30, 140);\n        energy = 'high';\n      } else if (lowerPrompt.includes('slow') || lowerPrompt.includes('chill') || lowerPrompt.includes('relaxed') || lowerPrompt.includes('ambient')) {\n        inferredTempo = Math.min(inferredTempo - 30, 70);\n        energy = 'low';\n      }\n\n      // Mood and key detection\n      if (lowerPrompt.includes('happy') || lowerPrompt.includes('joyful') || lowerPrompt.includes('uplifting') || lowerPrompt.includes('bright')) {\n        mood = 'happy';\n        inferredKey = ['C', 'G', 'D', 'F'][Math.floor(Math.random() * 4)]; // Major keys\n      } else if (lowerPrompt.includes('sad') || lowerPrompt.includes('melancholy') || lowerPrompt.includes('dark') || lowerPrompt.includes('emotional')) {\n        mood = 'sad';\n        inferredKey = ['A', 'E', 'B', 'F#'][Math.floor(Math.random() * 4)]; // Minor keys\n      } else if (lowerPrompt.includes('mysterious') || lowerPrompt.includes('dramatic') || lowerPrompt.includes('intense')) {\n        mood = 'dramatic';\n        inferredKey = ['F#', 'C#', 'G#'][Math.floor(Math.random() * 3)]; // Sharp keys\n      }\n\n      // Complexity detection\n      if (lowerPrompt.includes('simple') || lowerPrompt.includes('minimal') || lowerPrompt.includes('basic')) {\n        complexity = 'simple';\n      } else if (lowerPrompt.includes('complex') || lowerPrompt.includes('intricate') || lowerPrompt.includes('layered')) {\n        complexity = 'complex';\n      }\n\n      // Instrument detection\n      if (lowerPrompt.includes('piano')) instruments.push('piano');\n      if (lowerPrompt.includes('guitar')) instruments.push('guitar');\n      if (lowerPrompt.includes('drums')) instruments.push('drums');\n      if (lowerPrompt.includes('bass')) instruments.push('bass');\n      if (lowerPrompt.includes('strings')) instruments.push('strings');\n      return {\n        genre: inferredGenre,\n        tempo: inferredTempo,\n        key: inferredKey,\n        mood: mood,\n        instruments: instruments,\n        complexity: complexity,\n        energy: energy\n      };\n    }\n  };\n  const generateMusic = async () => {\n    setIsGenerating(true);\n    setGenerationError('');\n    setGenerationProgress(0);\n    setCurrentCommand('Running Music Generation');\n    try {\n      setGenerationStep('🎵 Initializing audio engine...');\n      setGenerationProgress(5);\n      if (Tone.context.state !== 'running') {\n        await Tone.start();\n      }\n\n      // AI Interpretation Step\n      setGenerationStep('🧠 Interpreting description with AI...');\n      setGenerationProgress(15);\n      let musicParams = {\n        genre: selectedGenre,\n        tempo: tempo,\n        key: key,\n        mood: 'neutral',\n        instruments: ['synth'],\n        complexity: 'medium',\n        energy: 'medium'\n      };\n      if (generationPrompt.trim()) {\n        console.log('🧠 Interpreting prompt:', generationPrompt);\n        musicParams = await interpretPromptWithLLM(generationPrompt);\n        console.log('🎯 AI interpretation:', musicParams);\n\n        // Update UI to show interpreted parameters\n        setSelectedGenre(musicParams.genre);\n        setTempo(musicParams.tempo);\n        setKey(musicParams.key);\n      }\n      setGenerationStep('🎛️ Creating virtual instruments...');\n      setGenerationProgress(25);\n\n      // Create instruments based on AI interpretation\n      const volumeBoost = musicParams.energy === 'high' ? 3 : musicParams.energy === 'low' ? -6 : 0;\n      const synth = new Tone.PolySynth(Tone.Synth, {\n        oscillator: {\n          type: musicParams.mood === 'sad' ? 'sine' : 'sawtooth'\n        },\n        envelope: {\n          attack: 0.1,\n          decay: 0.5,\n          sustain: 0.7,\n          release: 1.5\n        },\n        volume: -8 + volumeBoost\n      }).toDestination();\n      const bass = new Tone.MonoSynth({\n        oscillator: {\n          type: 'square'\n        },\n        envelope: {\n          attack: 0.1,\n          decay: 0.6,\n          sustain: 0.8,\n          release: 2.0\n        },\n        volume: -12 + volumeBoost\n      }).toDestination();\n      const drums = {\n        kick: new Tone.MembraneSynth({\n          pitchDecay: 0.05,\n          octaves: 10,\n          oscillator: {\n            type: 'sine'\n          },\n          envelope: {\n            attack: 0.001,\n            decay: 0.8,\n            sustain: 0.01,\n            release: 1.4\n          },\n          volume: -8 + volumeBoost\n        }).toDestination(),\n        snare: new Tone.NoiseSynth({\n          noise: {\n            type: 'white'\n          },\n          envelope: {\n            attack: 0.001,\n            decay: 0.3,\n            sustain: 0\n          },\n          volume: -12 + volumeBoost\n        }).toDestination(),\n        hihat: new Tone.MetalSynth({\n          envelope: {\n            attack: 0.001,\n            decay: 0.1,\n            sustain: 0\n          },\n          harmonicity: 5.1,\n          modulationIndex: 32,\n          resonance: 4000,\n          volume: -18 + volumeBoost\n        }).toDestination()\n      };\n      setGenerationStep('🎼 Generating chord progressions...');\n      setGenerationProgress(35);\n\n      // Generate musical elements based on interpretation\n      const scaleType = musicParams.mood === 'sad' ? 'minor' : musicParams.genre === 'blues' ? 'blues' : 'major';\n      const scaleNotes = getScale(musicParams.key, scaleType);\n      const progression = chordProgressions[musicParams.genre] || chordProgressions.pop;\n      const chords = generateChords(musicParams.key, progression);\n\n      // Adjust melody complexity based on AI interpretation\n      const melodyLength = musicParams.complexity === 'simple' ? 16 : musicParams.complexity === 'complex' ? 48 : 32;\n      const melody = generateMelody(scaleNotes, melodyLength);\n      if (!chords || chords.length === 0) {\n        throw new Error(`Failed to generate chords for ${musicParams.genre} in key ${musicParams.key}`);\n      }\n      setGenerationStep('🎚️ Creating sequences...');\n      setGenerationProgress(55);\n      Tone.Transport.bpm.value = musicParams.tempo;\n\n      // Create sequences with AI-influenced patterns\n      const chordSequence = new Tone.Sequence((time, chord) => {\n        if (chord && Array.isArray(chord) && chord.length >= 3) {\n          synth.triggerAttackRelease([`${chord[0]}3`, `${chord[1]}3`, `${chord[2]}3`], '2n', time);\n        }\n      }, chords, '2n');\n      const bassSequence = new Tone.Sequence((time, chord) => {\n        if (chord && Array.isArray(chord) && chord[0]) {\n          bass.triggerAttackRelease(`${chord[0]}2`, '4n', time);\n        }\n      }, chords, '4n');\n      const melodySequence = new Tone.Sequence((time, note) => {\n        if (note && note.note && note.octave) {\n          synth.triggerAttackRelease(`${note.note}${note.octave}`, '8n', time);\n        }\n      }, melody, '8n');\n\n      // Drum patterns based on energy level\n      const drumIntensity = musicParams.energy === 'high' ? {\n        kick: ['0:0', '0:2', '1:0', '1:2', '2:0', '2:2', '3:0', '3:2'],\n        snare: ['0:1', '1:1', '2:1', '3:1']\n      } : musicParams.energy === 'low' ? {\n        kick: ['0:0', '2:0'],\n        snare: ['1:0', '3:0']\n      } : {\n        kick: ['0:0', '1:0', '2:0', '3:0'],\n        snare: ['1:0', '3:0']\n      };\n      const kickSequence = new Tone.Sequence(time => {\n        drums.kick.triggerAttackRelease('C1', '8n', time);\n      }, drumIntensity.kick, '1n');\n      const snareSequence = new Tone.Sequence(time => {\n        drums.snare.triggerAttack(time);\n      }, drumIntensity.snare, '1n');\n      const hihatSequence = new Tone.Sequence(time => {\n        drums.hihat.triggerAttack(time);\n      }, ['0:0', '0:2', '1:0', '1:2', '2:0', '2:2', '3:0', '3:2'], '1n');\n      setGenerationStep('🎙️ Recording audio...');\n      setGenerationProgress(75);\n\n      // Start all sequences\n      chordSequence.start(0);\n      bassSequence.start(0);\n      melodySequence.start(0);\n      kickSequence.start(0);\n      snareSequence.start(0);\n      hihatSequence.start(0);\n      const recorder = new Tone.Recorder();\n      Tone.Destination.connect(recorder);\n      await recorder.start();\n      Tone.Transport.start();\n      setGenerationStep('⏳ Processing audio output...');\n      setGenerationProgress(85);\n      const progressInterval = setInterval(() => {\n        setGenerationProgress(prev => Math.min(prev + 1, 95));\n      }, duration * 1000 / 10);\n      setTimeout(async () => {\n        clearInterval(progressInterval);\n        setGenerationStep('💾 Finalizing track...');\n        setGenerationProgress(95);\n        Tone.Transport.stop();\n        const recording = await recorder.stop();\n\n        // Clean up\n        chordSequence.dispose();\n        bassSequence.dispose();\n        melodySequence.dispose();\n        kickSequence.dispose();\n        snareSequence.dispose();\n        hihatSequence.dispose();\n        synth.dispose();\n        bass.dispose();\n        drums.kick.dispose();\n        drums.snare.dispose();\n        drums.hihat.dispose();\n        recorder.dispose();\n        if (recording.size === 0) {\n          throw new Error('Recording is empty - no audio was captured');\n        }\n        const url = URL.createObjectURL(recording);\n        const trackName = `${musicParams.mood.charAt(0).toUpperCase() + musicParams.mood.slice(1)} ${musicParams.genre} in ${musicParams.key}`;\n        const newTrack = {\n          id: Date.now().toString(),\n          name: trackName,\n          url: url,\n          type: 'generated',\n          prompt: generationPrompt,\n          genre: musicParams.genre,\n          tempo: musicParams.tempo,\n          key: musicParams.key,\n          duration: duration,\n          sampleReference: (selectedSample === null || selectedSample === void 0 ? void 0 : selectedSample.title) || null\n        };\n        setTracks(prev => [...prev, newTrack]);\n        setGenerationPrompt('');\n        setGenerationStep('✅ Generation complete!');\n        setGenerationProgress(100);\n        setCurrentCommand('Track generated successfully');\n        setTimeout(() => {\n          setIsGenerating(false);\n          setGenerationProgress(0);\n          setGenerationStep('');\n          setCurrentCommand('Ready for next generation');\n        }, 2000);\n      }, duration * 1000);\n    } catch (error) {\n      console.error('❌ Generation failed:', error);\n      const errorMessage = error instanceof Error ? error.message : 'Unknown error occurred';\n      setGenerationError(`Failed to generate music: ${errorMessage}`);\n      setIsGenerating(false);\n      setGenerationProgress(0);\n      setGenerationStep('');\n      setCurrentCommand('Generation failed - ready to retry');\n    }\n  };\n  const handleFileUpload = async event => {\n    var _event$target$files;\n    const file = (_event$target$files = event.target.files) === null || _event$target$files === void 0 ? void 0 : _event$target$files[0];\n    if (file && file.type.startsWith('audio/')) {\n      setConnectionError('');\n      try {\n        const url = URL.createObjectURL(file);\n        const newTrack = {\n          id: Date.now().toString(),\n          name: file.name,\n          url: url,\n          type: 'uploaded',\n          duration: 0 // Will be set when audio loads\n        };\n        setTracks(prev => [...prev, newTrack]);\n      } catch (error) {\n        console.error('Upload failed:', error);\n        setConnectionError('Failed to upload file. Please try again.');\n      }\n    } else {\n      setConnectionError('Please select a valid audio file.');\n    }\n  };\n  const playSample = sample => {\n    console.log('🎵 Playing sample:', sample.title, 'URL:', sample.previewUrl);\n    if (samplePlaying === sample.id) {\n      if (sampleAudioRef.current) {\n        sampleAudioRef.current.pause();\n        sampleAudioRef.current.currentTime = 0;\n      }\n      setSamplePlaying(null);\n      return;\n    }\n    if (!sampleAudioRef.current) {\n      console.error('❌ Sample audio ref not available');\n      return;\n    }\n    try {\n      sampleAudioRef.current.pause();\n      sampleAudioRef.current.currentTime = 0;\n      sampleAudioRef.current.volume = 0.7;\n      sampleAudioRef.current.crossOrigin = \"anonymous\";\n      console.log('🔗 Setting audio source to:', sample.previewUrl);\n      sampleAudioRef.current.src = sample.previewUrl;\n      const playPromise = sampleAudioRef.current.play();\n      if (playPromise !== undefined) {\n        playPromise.then(() => {\n          console.log('✅ Sample playing successfully');\n          setSamplePlaying(sample.id);\n        }).catch(error => {\n          console.log('ℹ️ Sample URL blocked (expected due to CORS policy)');\n          console.log('💡 In a real app, samples would be hosted on the same domain');\n          setSamplePlaying(null);\n        });\n      }\n    } catch (error) {\n      console.log('ℹ️ Sample playback blocked by browser policy');\n      setSamplePlaying(null);\n    }\n  };\n  const playTrack = track => {\n    if ((currentTrack === null || currentTrack === void 0 ? void 0 : currentTrack.id) === track.id && isPlaying) {\n      if (audioElementRef.current) {\n        audioElementRef.current.pause();\n        audioElementRef.current.currentTime = 0;\n      }\n      setIsPlaying(false);\n    } else {\n      if (audioElementRef.current) {\n        // Stop any playing track first\n        audioElementRef.current.pause();\n        audioElementRef.current.currentTime = 0;\n        audioElementRef.current.src = track.url;\n        audioElementRef.current.play().catch(error => {\n          console.error('Error playing track:', error);\n          setIsPlaying(false);\n        });\n        setCurrentTrack(track);\n        setIsPlaying(true);\n      }\n    }\n  };\n  const downloadTrack = track => {\n    const link = document.createElement('a');\n    link.href = track.url;\n    link.download = `${track.name}.wav`;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  };\n  const deleteTrack = trackId => {\n    const track = tracks.find(t => t.id === trackId);\n    if (track && track.url && track.url.startsWith('blob:')) {\n      URL.revokeObjectURL(track.url);\n    }\n    setTracks(prev => prev.filter(track => track.id !== trackId));\n    if ((currentTrack === null || currentTrack === void 0 ? void 0 : currentTrack.id) === trackId) {\n      setCurrentTrack(null);\n      setIsPlaying(false);\n    }\n  };\n\n  // Cleanup URLs when component unmounts\n  useEffect(() => {\n    return () => {\n      tracks.forEach(track => {\n        if (track.url && track.url.startsWith('blob:')) {\n          URL.revokeObjectURL(track.url);\n        }\n      });\n    };\n  }, [tracks]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 text-white\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container mx-auto px-4 py-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center justify-between mb-8\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-3\",\n          children: [/*#__PURE__*/_jsxDEV(Music, {\n            className: \"w-8 h-8 text-purple-400\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 831,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n            className: \"text-3xl font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent\",\n            children: \"AI Music Creator\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 832,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 830,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-4\",\n          children: /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            value: projectName,\n            onChange: e => setProjectName(e.target.value),\n            className: \"bg-white/10 border border-white/20 px-3 py-2 rounded-lg text-white placeholder-white/60\",\n            placeholder: \"Project Name\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 837,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 836,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 829,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-1 lg:grid-cols-4 gap-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"text-xl font-semibold mb-4 flex items-center space-x-2\",\n            children: [/*#__PURE__*/_jsxDEV(Music, {\n              className: \"w-5 h-5\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 851,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Training Database\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 852,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 850,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-4\",\n            children: [loadingSamples && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-center py-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-sm text-white/60\",\n                children: \"Loading royalty-free music database...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 858,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-xs text-white/40 mt-1\",\n                children: \"Kevin MacLeod collection\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 859,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 857,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              value: searchTerm,\n              onChange: e => setSearchTerm(e.target.value),\n              placeholder: \"Search samples...\",\n              className: \"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-white/60\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 863,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"max-h-80 overflow-y-auto space-y-2\",\n              children: filteredSamples.map(sample => /*#__PURE__*/_jsxDEV(\"div\", {\n                onClick: () => setSelectedSample(sample),\n                className: `p-3 rounded-lg cursor-pointer transition-all ${(selectedSample === null || selectedSample === void 0 ? void 0 : selectedSample.id) === sample.id ? 'bg-purple-600/50 border border-purple-400' : 'bg-white/5 hover:bg-white/10 border border-white/10'}`,\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-sm font-medium\",\n                  children: sample.title\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 882,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-xs text-white/60\",\n                  children: sample.artist\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 883,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center justify-between mt-1\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-xs bg-white/20 px-2 py-1 rounded capitalize\",\n                    children: sample.genre\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 885,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex items-center space-x-2\",\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"text-xs text-white/60\",\n                      children: [sample.tempo, \" BPM \\u2022 \", sample.key]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 889,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                      onClick: e => {\n                        e.stopPropagation();\n                        playSample(sample);\n                      },\n                      className: \"bg-blue-600 hover:bg-blue-700 p-1 rounded-full transition-colors\",\n                      title: \"Preview sample\",\n                      children: samplePlaying === sample.id ? /*#__PURE__*/_jsxDEV(Pause, {\n                        className: \"w-3 h-3\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 901,\n                        columnNumber: 29\n                      }, this) : /*#__PURE__*/_jsxDEV(Play, {\n                        className: \"w-3 h-3\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 903,\n                        columnNumber: 29\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 892,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 888,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 884,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex flex-wrap gap-1 mt-2\",\n                  children: sample.tags.slice(0, 2).map(tag => /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-xs bg-blue-500/30 px-1 py-0.5 rounded\",\n                    children: tag\n                  }, tag, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 910,\n                    columnNumber: 25\n                  }, this))\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 908,\n                  columnNumber: 21\n                }, this)]\n              }, sample.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 873,\n                columnNumber: 19\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 871,\n              columnNumber: 15\n            }, this), selectedSample && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-purple-500/20 border border-purple-400/50 rounded-lg p-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-sm font-medium text-purple-200\",\n                children: \"Selected Reference:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 921,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-xs text-purple-300\",\n                children: selectedSample.title\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 922,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-xs text-purple-400 mt-1\",\n                children: [\"Mood: \", selectedSample.mood, \" \\u2022 Style: \", selectedSample.genre]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 923,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 920,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 855,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 849,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lg:col-span-2 space-y-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20\",\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              className: \"text-xl font-semibold mb-4 flex items-center space-x-2\",\n              children: [/*#__PURE__*/_jsxDEV(Radio, {\n                className: \"w-5 h-5\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 936,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"AI Music Generation\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 937,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 935,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-black/30 border border-white/20 rounded-lg p-3 mb-4 font-mono text-sm\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center justify-between mb-1\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-green-400\",\n                  children: \"Status:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 943,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center space-x-2\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-white\",\n                    children: connectionStatus\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 945,\n                    columnNumber: 21\n                  }, this), (connectionStatus.includes('❌') || connectionStatus.includes('Offline')) && /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: checkBackendConnection,\n                    disabled: isCheckingConnection,\n                    className: \"bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed px-2 py-1 rounded text-xs transition-colors\",\n                    title: \"Retry backend connection\",\n                    children: isCheckingConnection ? '🔄' : '🔄 Retry'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 947,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 944,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 942,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-blue-400\",\n                  children: \"Command:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 959,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-white\",\n                  children: currentCommand\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 960,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 958,\n                columnNumber: 17\n              }, this), generationStep && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center justify-between mt-1\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-yellow-400\",\n                  children: \"Process:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 964,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-white\",\n                  children: generationStep\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 965,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 963,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 941,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"space-y-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n                value: generationPrompt,\n                onChange: e => setGenerationPrompt(e.target.value),\n                placeholder: \"Describe the music you want to create... (e.g., 'upbeat pop song with guitar and drums, happy mood')\",\n                className: \"w-full h-24 bg-white/10 border border-white/20 rounded-lg px-4 py-3 text-white placeholder-white/60 resize-none\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 971,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"grid grid-cols-2 md:grid-cols-4 gap-4\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"block text-sm font-medium mb-2\",\n                    children: \"Genre\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 980,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                    value: selectedGenre,\n                    onChange: e => setSelectedGenre(e.target.value),\n                    className: \"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white\",\n                    children: genres.map(genre => /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: genre,\n                      className: \"bg-gray-800\",\n                      children: genre.charAt(0).toUpperCase() + genre.slice(1)\n                    }, genre, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 987,\n                      columnNumber: 25\n                    }, this))\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 981,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 979,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"block text-sm font-medium mb-2\",\n                    children: \"Tempo (BPM)\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 995,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"range\",\n                    min: \"60\",\n                    max: \"200\",\n                    value: tempo,\n                    onChange: e => setTempo(Number(e.target.value)),\n                    className: \"w-full\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 996,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-center text-sm text-white/70\",\n                    children: tempo\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1004,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 994,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"block text-sm font-medium mb-2\",\n                    children: \"Key\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1008,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                    value: key,\n                    onChange: e => setKey(e.target.value),\n                    className: \"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white\",\n                    children: keys.map(k => /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: k,\n                      className: \"bg-gray-800\",\n                      children: k\n                    }, k, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1015,\n                      columnNumber: 25\n                    }, this))\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1009,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1007,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"block text-sm font-medium mb-2\",\n                    children: \"Duration (s)\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1021,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"range\",\n                    min: \"10\",\n                    max: \"120\",\n                    value: duration,\n                    onChange: e => setDuration(Number(e.target.value)),\n                    className: \"w-full\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1022,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-center text-sm text-white/70\",\n                    children: [duration, \"s\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1030,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1020,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 978,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: generateMusic,\n                disabled: isGenerating,\n                className: \"w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 disabled:opacity-50 disabled:cursor-not-allowed px-6 py-3 rounded-lg font-semibold transition-all duration-200\",\n                children: isGenerating ? `Generating Music... ${generationProgress}%` : 'Generate Music'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1034,\n                columnNumber: 17\n              }, this), isGenerating && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"w-full bg-white/20 rounded-full h-2\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"bg-gradient-to-r from-purple-400 to-pink-400 h-2 rounded-full transition-all duration-300\",\n                  style: {\n                    width: `${generationProgress}%`\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1045,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1044,\n                columnNumber: 19\n              }, this), generationError && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"bg-red-500/20 border border-red-500/50 rounded-lg p-3 text-red-200\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center space-x-2\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-red-400\",\n                    children: \"\\u26A0\\uFE0F\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1056,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    children: generationError\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1057,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1055,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => setGenerationError(''),\n                  className: \"text-red-400 hover:text-red-300 text-sm mt-1\",\n                  children: \"Dismiss\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1059,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1054,\n                columnNumber: 19\n              }, this), connectionError && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"bg-orange-500/20 border border-orange-500/50 rounded-lg p-3 text-orange-200\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center space-x-2\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-orange-400\",\n                    children: \"\\u26A0\\uFE0F\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1071,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    children: connectionError\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1072,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1070,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => setConnectionError(''),\n                  className: \"text-orange-400 hover:text-orange-300 text-sm mt-1\",\n                  children: \"Dismiss\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1074,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1069,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 970,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 934,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20\",\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              className: \"text-xl font-semibold mb-4 flex items-center space-x-2\",\n              children: [/*#__PURE__*/_jsxDEV(Upload, {\n                className: \"w-5 h-5\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1088,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Upload Audio\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1089,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1087,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"w-full bg-indigo-600 hover:bg-indigo-700 px-4 py-3 rounded-lg flex items-center justify-center space-x-2 cursor-pointer transition-colors\",\n              children: [/*#__PURE__*/_jsxDEV(Upload, {\n                className: \"w-4 h-4\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1093,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Upload Audio File\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1094,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"file\",\n                accept: \"audio/*\",\n                onChange: handleFileUpload,\n                className: \"hidden\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1095,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1092,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1086,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 932,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"text-xl font-semibold mb-4 flex items-center space-x-2\",\n            children: [/*#__PURE__*/_jsxDEV(Volume2, {\n              className: \"w-5 h-5\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1108,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [\"Tracks (\", tracks.length, \")\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1109,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1107,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-3 max-h-96 overflow-y-auto\",\n            children: [tracks.map(track => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `bg-white/10 rounded-lg p-4 border ${(currentTrack === null || currentTrack === void 0 ? void 0 : currentTrack.id) === track.id ? 'border-purple-400' : 'border-white/20'}`,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center justify-between mb-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  className: \"font-medium truncate flex-1\",\n                  children: track.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1121,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex space-x-1\",\n                  children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: () => downloadTrack(track),\n                    className: \"text-green-400 hover:text-green-300\",\n                    title: \"Download\",\n                    children: /*#__PURE__*/_jsxDEV(Download, {\n                      className: \"w-4 h-4\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1128,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1123,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: () => deleteTrack(track.id),\n                    className: \"text-red-400 hover:text-red-300\",\n                    title: \"Delete\",\n                    children: /*#__PURE__*/_jsxDEV(Trash2, {\n                      className: \"w-4 h-4\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1135,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1130,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1122,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1120,\n                columnNumber: 19\n              }, this), track.type === 'generated' && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-xs text-white/60 mb-2\",\n                children: [track.genre, \" \\u2022 \", track.key, \" \\u2022 \", track.tempo, \" BPM\", track.sampleReference && /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"ml-1\",\n                  children: [\"\\u2022 Ref: \", track.sampleReference]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1144,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1141,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-xs text-white/60 capitalize\",\n                  children: track.type\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1150,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => playTrack(track),\n                  className: \"bg-purple-600 hover:bg-purple-700 p-2 rounded-full transition-colors\",\n                  children: (currentTrack === null || currentTrack === void 0 ? void 0 : currentTrack.id) === track.id && isPlaying ? /*#__PURE__*/_jsxDEV(Pause, {\n                    className: \"w-4 h-4\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1156,\n                    columnNumber: 25\n                  }, this) : /*#__PURE__*/_jsxDEV(Play, {\n                    className: \"w-4 h-4\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1158,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1151,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1149,\n                columnNumber: 19\n              }, this)]\n            }, track.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1114,\n              columnNumber: 17\n            }, this)), tracks.length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-center py-8 text-white/60\",\n              children: [/*#__PURE__*/_jsxDEV(Music, {\n                className: \"w-12 h-12 mx-auto mb-3 opacity-50\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1167,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"No tracks yet. Generate or upload some music!\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1168,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1166,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1112,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1106,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 847,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 827,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"audio\", {\n      ref: audioElementRef,\n      onEnded: () => setIsPlaying(false),\n      onPause: () => setIsPlaying(false),\n      onError: e => {\n        console.error('Audio error:', e);\n        setIsPlaying(false);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1176,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"audio\", {\n      ref: sampleAudioRef,\n      onEnded: () => setSamplePlaying(null),\n      onPause: () => setSamplePlaying(null),\n      onError: e => {\n        console.error('Sample audio error:', e);\n        setSamplePlaying(null);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1186,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 826,\n    columnNumber: 5\n  }, this);\n};\n_s(AIMusicsCreator, \"Vw2RjAXd4+nq1JbOd5mPimIZnuA=\");\n_c = AIMusicsCreator;\nexport default AIMusicsCreator;\nvar _c;\n$RefreshReg$(_c, \"AIMusicsCreator\");","map":{"version":3,"names":["React","useState","useRef","useEffect","Play","Pause","Upload","Download","Music","Radio","Volume2","Trash2","Tone","jsxDEV","_jsxDEV","AIMusicsCreator","_s","isPlaying","setIsPlaying","currentTrack","setCurrentTrack","tracks","setTracks","projectName","setProjectName","generationPrompt","setGenerationPrompt","isGenerating","setIsGenerating","selectedGenre","setSelectedGenre","tempo","setTempo","key","setKey","duration","setDuration","generationError","setGenerationError","connectionError","setConnectionError","generationProgress","setGenerationProgress","currentCommand","setCurrentCommand","connectionStatus","setConnectionStatus","generationStep","setGenerationStep","searchTerm","setSearchTerm","selectedSample","setSelectedSample","samplePlaying","setSamplePlaying","loadingSamples","setLoadingSamples","sampleDatabaseLoaded","setSampleDatabaseLoaded","isCheckingConnection","setIsCheckingConnection","audioElementRef","sampleAudioRef","fallbackSamples","id","title","artist","genre","mood","tags","previewUrl","fetchSamplesFromFMA","console","log","Promise","resolve","setTimeout","error","warn","loadSamples","samples","sampleDatabase","length","genres","keys","scales","major","minor","blues","pentatonic","chordProgressions","pop","rock","jazz","filteredSamples","filter","sample","toLowerCase","includes","some","tag","getScale","rootNote","scaleType","noteNames","rootIndex","indexOf","scale","map","interval","noteIndex","generateMelody","scaleNotes","melody","i","Math","random","floor","octave","push","note","time","generateChords","progression","chord","chordRoot","chordScale","checkBackendConnection","response","fetch","method","headers","signal","AbortSignal","timeout","ok","data","json","Error","status","statusText","name","message","interpretPromptWithLLM","prompt","body","JSON","stringify","availableGenres","availableKeys","currentGenre","currentTempo","currentKey","interpretation","lowerPrompt","inferredGenre","inferredTempo","inferredKey","instruments","complexity","energy","genreKeywords","electronic","classical","country","maxMatches","Object","entries","forEach","keywords","matches","keyword","max","min","generateMusic","context","state","start","musicParams","trim","volumeBoost","synth","PolySynth","Synth","oscillator","type","envelope","attack","decay","sustain","release","volume","toDestination","bass","MonoSynth","drums","kick","MembraneSynth","pitchDecay","octaves","snare","NoiseSynth","noise","hihat","MetalSynth","harmonicity","modulationIndex","resonance","chords","melodyLength","Transport","bpm","value","chordSequence","Sequence","Array","isArray","triggerAttackRelease","bassSequence","melodySequence","drumIntensity","kickSequence","snareSequence","triggerAttack","hihatSequence","recorder","Recorder","Destination","connect","progressInterval","setInterval","prev","clearInterval","stop","recording","dispose","size","url","URL","createObjectURL","trackName","charAt","toUpperCase","slice","newTrack","Date","now","toString","sampleReference","errorMessage","handleFileUpload","event","_event$target$files","file","target","files","startsWith","playSample","current","pause","currentTime","crossOrigin","src","playPromise","play","undefined","then","catch","playTrack","track","downloadTrack","link","document","createElement","href","download","appendChild","click","removeChild","deleteTrack","trackId","find","t","revokeObjectURL","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onChange","e","placeholder","onClick","stopPropagation","disabled","Number","k","style","width","accept","ref","onEnded","onPause","onError","_c","$RefreshReg$"],"sources":["/Users/ewanmcphilliamy/Documents/SunoLikeAppByCluade/ai-music-creator/frontend/src/App.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport { Play, Pause, Upload, Download, Music, Radio, Volume2, Trash2 } from 'lucide-react';\nimport * as Tone from 'tone';\n\ninterface Track {\n  id: string;\n  name: string;\n  url: string;\n  type: 'generated' | 'uploaded';\n  prompt?: string;\n  genre?: string;\n  tempo?: number;\n  key?: string;\n  duration?: number;\n  sampleReference?: string | null;\n}\n\ninterface Sample {\n  id: number;\n  title: string;\n  artist: string;\n  genre: string;\n  tempo: number;\n  key: string;\n  mood: string;\n  tags: string[];\n  previewUrl: string;\n}\n\ninterface MelodyNote {\n  note: string;\n  octave: number;\n  time: number;\n}\n\nconst AIMusicsCreator: React.FC = () => {\n  const [isPlaying, setIsPlaying] = useState<boolean>(false);\n  const [currentTrack, setCurrentTrack] = useState<Track | null>(null);\n  const [tracks, setTracks] = useState<Track[]>([]);\n  const [projectName, setProjectName] = useState<string>('Untitled Project');\n  const [generationPrompt, setGenerationPrompt] = useState<string>('');\n  const [isGenerating, setIsGenerating] = useState<boolean>(false);\n  const [selectedGenre, setSelectedGenre] = useState<string>('pop');\n  const [tempo, setTempo] = useState<number>(120);\n  const [key, setKey] = useState<string>('C');\n  const [duration, setDuration] = useState<number>(30);\n  const [generationError, setGenerationError] = useState<string>('');\n  const [connectionError, setConnectionError] = useState<string>('');\n  const [generationProgress, setGenerationProgress] = useState<number>(0);\n  const [currentCommand, setCurrentCommand] = useState<string>('Idle');\n  const [connectionStatus, setConnectionStatus] = useState<string>('Connecting...');\n  const [generationStep, setGenerationStep] = useState<string>('');\n  const [searchTerm, setSearchTerm] = useState<string>('');\n  const [selectedSample, setSelectedSample] = useState<Sample | null>(null);\n  const [samplePlaying, setSamplePlaying] = useState<number | null>(null);\n  const [loadingSamples, setLoadingSamples] = useState<boolean>(false);\n  const [sampleDatabaseLoaded, setSampleDatabaseLoaded] = useState<Sample[]>([]);\n  const [isCheckingConnection, setIsCheckingConnection] = useState<boolean>(false);\n\n  const audioElementRef = useRef<HTMLAudioElement>(null);\n  const sampleAudioRef = useRef<HTMLAudioElement>(null);\n\n  // Royalty-free music database with actual working URLs\n  const fallbackSamples: Sample[] = [\n    { \n      id: 1, \n      title: \"Acoustic Folk\", \n      artist: \"Kevin MacLeod\", \n      genre: \"folk\", \n      tempo: 120, \n      key: \"C\", \n      mood: \"peaceful\", \n      tags: [\"acoustic\", \"guitar\", \"calm\"], \n      previewUrl: \"https://incompetech.com/music/royalty-free/mp3-royaltyfree/Carefree.mp3\" \n    },\n    { \n      id: 2, \n      title: \"Electronic Chill\", \n      artist: \"Kevin MacLeod\", \n      genre: \"electronic\", \n      tempo: 128, \n      key: \"G\", \n      mood: \"energetic\", \n      tags: [\"electronic\", \"beat\", \"synth\"], \n      previewUrl: \"https://incompetech.com/music/royalty-free/mp3-royaltyfree/Electrodoodle.mp3\" \n    },\n    { \n      id: 3, \n      title: \"Jazz Lounge\", \n      artist: \"Kevin MacLeod\", \n      genre: \"jazz\", \n      tempo: 110, \n      key: \"F\", \n      mood: \"sophisticated\", \n      tags: [\"jazz\", \"piano\", \"smooth\"], \n      previewUrl: \"https://incompetech.com/music/royalty-free/mp3-royaltyfree/Heinousity.mp3\" \n    },\n    { \n      id: 4, \n      title: \"Rock Energy\", \n      artist: \"Kevin MacLeod\", \n      genre: \"rock\", \n      tempo: 140, \n      key: \"E\", \n      mood: \"energetic\", \n      tags: [\"rock\", \"guitar\", \"driving\"], \n      previewUrl: \"https://incompetech.com/music/royalty-free/mp3-royaltyfree/Funky%20Suspense.mp3\" \n    },\n    { \n      id: 5, \n      title: \"Ambient Space\", \n      artist: \"Kevin MacLeod\", \n      genre: \"ambient\", \n      tempo: 80, \n      key: \"A\", \n      mood: \"dreamy\", \n      tags: [\"ambient\", \"synth\", \"atmospheric\"], \n      previewUrl: \"https://incompetech.com/music/royalty-free/mp3-royaltyfree/Cipher.mp3\" \n    },\n    { \n      id: 6, \n      title: \"Hip Hop Groove\", \n      artist: \"Kevin MacLeod\", \n      genre: \"hip-hop\", \n      tempo: 95, \n      key: \"D\", \n      mood: \"cool\", \n      tags: [\"hip-hop\", \"beat\", \"urban\"], \n      previewUrl: \"https://incompetech.com/music/royalty-free/mp3-royaltyfree/Sneaky%20Snitch.mp3\" \n    },\n    { \n      id: 7, \n      title: \"Classical Piano\", \n      artist: \"Kevin MacLeod\", \n      genre: \"classical\", \n      tempo: 70, \n      key: \"C\", \n      mood: \"elegant\", \n      tags: [\"classical\", \"piano\", \"orchestral\"], \n      previewUrl: \"https://incompetech.com/music/royalty-free/mp3-royaltyfree/Deliberate%20Thought.mp3\" \n    },\n    { \n      id: 8, \n      title: \"Indie Pop\", \n      artist: \"Kevin MacLeod\", \n      genre: \"pop\", \n      tempo: 125, \n      key: \"G\", \n      mood: \"upbeat\", \n      tags: [\"pop\", \"indie\", \"catchy\"], \n      previewUrl: \"https://incompetech.com/music/royalty-free/mp3-royaltyfree/Happy%20Boy%20End%20Theme.mp3\" \n    },\n    { \n      id: 9, \n      title: \"Country Folk\", \n      artist: \"Kevin MacLeod\", \n      genre: \"country\", \n      tempo: 100, \n      key: \"D\", \n      mood: \"nostalgic\", \n      tags: [\"country\", \"folk\", \"acoustic\"], \n      previewUrl: \"https://incompetech.com/music/royalty-free/mp3-royaltyfree/Danse%20Morialta.mp3\" \n    },\n    { \n      id: 10, \n      title: \"Blues Guitar\", \n      artist: \"Kevin MacLeod\", \n      genre: \"blues\", \n      tempo: 75, \n      key: \"A\", \n      mood: \"soulful\", \n      tags: [\"blues\", \"guitar\", \"emotional\"], \n      previewUrl: \"https://incompetech.com/music/royalty-free/mp3-royaltyfree/Laid%20Back%20Guitars.mp3\" \n    }\n  ];\n\n  // Fetch samples from Free Music Archive API\n  const fetchSamplesFromFMA = async (): Promise<Sample[]> => {\n    try {\n      setLoadingSamples(true);\n      console.log('🎵 Loading royalty-free music database...');\n      \n      // For now, we'll use the curated Kevin MacLeod collection\n      // These are all royalty-free and hosted on Incompetech\n      console.log('✅ Using Kevin MacLeod royalty-free music collection');\n      \n      // Simulate loading time for realistic feel\n      await new Promise(resolve => setTimeout(resolve, 1000));\n      \n      return fallbackSamples;\n      \n    } catch (error) {\n      console.warn('Could not load music database, using fallback samples:', error);\n      return fallbackSamples;\n    } finally {\n      setLoadingSamples(false);\n    }\n  };\n\n  // Load samples on component mount\n  useEffect(() => {\n    const loadSamples = async () => {\n      const samples = await fetchSamplesFromFMA();\n      setSampleDatabaseLoaded(samples);\n    };\n    loadSamples();\n  }, []);\n\n  // Use loaded samples or fallback\n  const sampleDatabase = sampleDatabaseLoaded.length > 0 ? sampleDatabaseLoaded : fallbackSamples;\n\n  const genres: string[] = ['pop', 'rock', 'jazz', 'electronic', 'hip-hop', 'classical', 'country', 'blues'];\n  const keys: string[] = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];\n\n  // Music theory data\n  const scales: Record<string, number[]> = {\n    major: [0, 2, 4, 5, 7, 9, 11],\n    minor: [0, 2, 3, 5, 7, 8, 10],\n    blues: [0, 3, 5, 6, 7, 10],\n    pentatonic: [0, 2, 4, 7, 9]\n  };\n\n  const chordProgressions: Record<string, string[]> = {\n    pop: ['I', 'V', 'vi', 'IV'],\n    rock: ['I', 'bVII', 'IV', 'I'],\n    jazz: ['I', 'vi', 'ii', 'V'],\n    blues: ['I', 'I', 'I', 'I', 'IV', 'IV', 'I', 'I', 'V', 'IV', 'I', 'V']\n  };\n\n  const filteredSamples = sampleDatabase.filter(sample => \n    sample.title.toLowerCase().includes(searchTerm.toLowerCase()) ||\n    sample.artist.toLowerCase().includes(searchTerm.toLowerCase()) ||\n    sample.genre.toLowerCase().includes(searchTerm.toLowerCase()) ||\n    sample.tags.some(tag => tag.toLowerCase().includes(searchTerm.toLowerCase()))\n  );\n\n  const getScale = (rootNote: string, scaleType: string): string[] => {\n    const noteNames: string[] = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];\n    const rootIndex = noteNames.indexOf(rootNote);\n    const scale = scales[scaleType] || scales.major;\n    \n    return scale.map(interval => {\n      const noteIndex = (rootIndex + interval) % 12;\n      return noteNames[noteIndex];\n    });\n  };\n\n  const generateMelody = (scaleNotes: string[], length: number = 16): (MelodyNote | null)[] => {\n    const melody: (MelodyNote | null)[] = [];\n    for (let i = 0; i < length; i++) {\n      if (Math.random() > 0.2) { // 80% chance to play a note\n        const noteIndex = Math.floor(Math.random() * scaleNotes.length);\n        const octave = 4 + Math.floor(Math.random() * 2); // Octave 4 or 5\n        melody.push({\n          note: scaleNotes[noteIndex],\n          octave: octave,\n          time: i * 0.25 // 16th notes\n        });\n      } else {\n        melody.push(null);\n      }\n    }\n    return melody;\n  };\n\n  const generateChords = (rootNote: string, progression: string[]): string[][] => {\n    const noteNames: string[] = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];\n    const rootIndex = noteNames.indexOf(rootNote);\n    const scale = getScale(rootNote, 'major');\n    \n    return progression.map(chord => {\n      let chordRoot: string;\n      switch (chord) {\n        case 'I': chordRoot = scale[0]; break;\n        case 'ii': chordRoot = scale[1]; break;\n        case 'iii': chordRoot = scale[2]; break;\n        case 'IV': chordRoot = scale[3]; break;\n        case 'V': chordRoot = scale[4]; break;\n        case 'vi': chordRoot = scale[5]; break;\n        case 'bVII': chordRoot = noteNames[(rootIndex + 10) % 12]; break;\n        default: chordRoot = scale[0];\n      }\n      \n      // Generate triad - ensure we always return a valid array\n      const chordScale = getScale(chordRoot, 'major');\n      return [\n        chordScale[0] || 'C', \n        chordScale[2] || 'E', \n        chordScale[4] || 'G'\n      ]; // Root, third, fifth with fallbacks\n    }).filter(chord => chord && chord.length === 3); // Filter out any invalid chords\n  };\n\n  // Check backend connection\n  const checkBackendConnection = async (): Promise<void> => {\n    try {\n      setIsCheckingConnection(true);\n      setCurrentCommand('Checking backend connection...');\n      setConnectionStatus('🔄 Connecting...');\n      setConnectionError(''); // Clear any previous errors\n      \n      // Actually test the backend connection\n      const response = await fetch('http://localhost:3001/api/health', {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        signal: AbortSignal.timeout(5000), // 5 second timeout\n      });\n      \n      if (response.ok) {\n        const data = await response.json();\n        setConnectionStatus('✅ Connected to Backend');\n        setCurrentCommand('Backend online - ready for generation');\n        console.log('✅ Backend connection successful:', data);\n      } else {\n        throw new Error(`Backend returned ${response.status}: ${response.statusText}`);\n      }\n    } catch (error) {\n      console.error('❌ Backend connection failed:', error);\n      setConnectionStatus('❌ Backend Offline');\n      \n      if (error instanceof Error) {\n        if (error.name === 'TimeoutError') {\n          setConnectionError('Backend connection timeout. Is the server running on port 3001?');\n        } else if (error.message.includes('fetch')) {\n          setConnectionError('Cannot reach backend server. Please start the backend on port 3001.');\n        } else {\n          setConnectionError(`Backend error: ${error.message}`);\n        }\n      } else {\n        setConnectionError('Unknown backend connection error.');\n      }\n      \n      setCurrentCommand('Backend offline - using local generation only');\n    } finally {\n      setIsCheckingConnection(false);\n    }\n  };\n\n  // Check backend connection on mount\n  useEffect(() => {\n    checkBackendConnection();\n  }, []);\n\n  const interpretPromptWithLLM = async (prompt: string): Promise<{\n    genre: string;\n    tempo: number;\n    key: string;\n    mood: string;\n    instruments: string[];\n    complexity: string;\n    energy: string;\n  }> => {\n    try {\n      setCurrentCommand('🧠 AI analyzing prompt...');\n      \n      // Call backend LLM service\n      const response = await fetch('http://localhost:3001/api/interpret-prompt', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          prompt: prompt,\n          availableGenres: genres,\n          availableKeys: keys,\n          currentGenre: selectedGenre,\n          currentTempo: tempo,\n          currentKey: key\n        })\n      });\n      \n      if (response.ok) {\n        const interpretation = await response.json();\n        console.log('🎯 LLM interpretation:', interpretation);\n        return interpretation;\n      } else {\n        throw new Error('LLM service unavailable');\n      }\n    } catch (error) {\n      console.log('🔄 LLM unavailable, using enhanced keyword matching');\n      \n      // Enhanced fallback with better keyword detection\n      const lowerPrompt = prompt.toLowerCase();\n      \n      let inferredGenre = selectedGenre;\n      let inferredTempo = tempo;\n      let inferredKey = key;\n      let mood = 'neutral';\n      let instruments = ['synth'];\n      let complexity = 'medium';\n      let energy = 'medium';\n      \n      // Advanced genre detection\n      const genreKeywords = {\n        rock: ['rock', 'guitar', 'heavy', 'metal', 'grunge', 'punk', 'alternative'],\n        jazz: ['jazz', 'swing', 'saxophone', 'trumpet', 'bebop', 'smooth', 'improvisation'],\n        electronic: ['electronic', 'edm', 'techno', 'house', 'trance', 'dubstep', 'synth', 'digital'],\n        blues: ['blues', 'mississippi', 'chicago', 'delta', 'harmonica', 'slide guitar'],\n        pop: ['pop', 'catchy', 'radio', 'mainstream', 'chart', 'commercial', 'vocals'],\n        classical: ['classical', 'orchestra', 'symphony', 'piano', 'violin', 'baroque', 'romantic'],\n        'hip-hop': ['hip hop', 'rap', 'urban', 'beats', 'sampling', 'mc', 'breakbeat'],\n        country: ['country', 'western', 'nashville', 'banjo', 'fiddle', 'honky tonk']\n      };\n      \n      // Find best matching genre\n      let maxMatches = 0;\n      Object.entries(genreKeywords).forEach(([genre, keywords]) => {\n        const matches = keywords.filter(keyword => lowerPrompt.includes(keyword)).length;\n        if (matches > maxMatches) {\n          maxMatches = matches;\n          inferredGenre = genre;\n        }\n      });\n      \n      // Tempo and energy detection\n      if (lowerPrompt.includes('fast') || lowerPrompt.includes('upbeat') || lowerPrompt.includes('energetic') || lowerPrompt.includes('driving')) {\n        inferredTempo = Math.max(inferredTempo + 30, 140);\n        energy = 'high';\n      } else if (lowerPrompt.includes('slow') || lowerPrompt.includes('chill') || lowerPrompt.includes('relaxed') || lowerPrompt.includes('ambient')) {\n        inferredTempo = Math.min(inferredTempo - 30, 70);\n        energy = 'low';\n      }\n      \n      // Mood and key detection\n      if (lowerPrompt.includes('happy') || lowerPrompt.includes('joyful') || lowerPrompt.includes('uplifting') || lowerPrompt.includes('bright')) {\n        mood = 'happy';\n        inferredKey = ['C', 'G', 'D', 'F'][Math.floor(Math.random() * 4)]; // Major keys\n      } else if (lowerPrompt.includes('sad') || lowerPrompt.includes('melancholy') || lowerPrompt.includes('dark') || lowerPrompt.includes('emotional')) {\n        mood = 'sad';\n        inferredKey = ['A', 'E', 'B', 'F#'][Math.floor(Math.random() * 4)]; // Minor keys\n      } else if (lowerPrompt.includes('mysterious') || lowerPrompt.includes('dramatic') || lowerPrompt.includes('intense')) {\n        mood = 'dramatic';\n        inferredKey = ['F#', 'C#', 'G#'][Math.floor(Math.random() * 3)]; // Sharp keys\n      }\n      \n      // Complexity detection\n      if (lowerPrompt.includes('simple') || lowerPrompt.includes('minimal') || lowerPrompt.includes('basic')) {\n        complexity = 'simple';\n      } else if (lowerPrompt.includes('complex') || lowerPrompt.includes('intricate') || lowerPrompt.includes('layered')) {\n        complexity = 'complex';\n      }\n      \n      // Instrument detection\n      if (lowerPrompt.includes('piano')) instruments.push('piano');\n      if (lowerPrompt.includes('guitar')) instruments.push('guitar');\n      if (lowerPrompt.includes('drums')) instruments.push('drums');\n      if (lowerPrompt.includes('bass')) instruments.push('bass');\n      if (lowerPrompt.includes('strings')) instruments.push('strings');\n      \n      return {\n        genre: inferredGenre,\n        tempo: inferredTempo,\n        key: inferredKey,\n        mood: mood,\n        instruments: instruments,\n        complexity: complexity,\n        energy: energy\n      };\n    }\n  };\n\n  const generateMusic = async (): Promise<void> => {\n    setIsGenerating(true);\n    setGenerationError('');\n    setGenerationProgress(0);\n    setCurrentCommand('Running Music Generation');\n    \n    try {\n      setGenerationStep('🎵 Initializing audio engine...');\n      setGenerationProgress(5);\n      \n      if (Tone.context.state !== 'running') {\n        await Tone.start();\n      }\n\n      // AI Interpretation Step\n      setGenerationStep('🧠 Interpreting description with AI...');\n      setGenerationProgress(15);\n\n      let musicParams = {\n        genre: selectedGenre,\n        tempo: tempo,\n        key: key,\n        mood: 'neutral',\n        instruments: ['synth'],\n        complexity: 'medium',\n        energy: 'medium'\n      };\n\n      if (generationPrompt.trim()) {\n        console.log('🧠 Interpreting prompt:', generationPrompt);\n        musicParams = await interpretPromptWithLLM(generationPrompt);\n        console.log('🎯 AI interpretation:', musicParams);\n        \n        // Update UI to show interpreted parameters\n        setSelectedGenre(musicParams.genre);\n        setTempo(musicParams.tempo);\n        setKey(musicParams.key);\n      }\n\n      setGenerationStep('🎛️ Creating virtual instruments...');\n      setGenerationProgress(25);\n\n      // Create instruments based on AI interpretation\n      const volumeBoost = musicParams.energy === 'high' ? 3 : musicParams.energy === 'low' ? -6 : 0;\n      \n      const synth = new Tone.PolySynth(Tone.Synth, {\n        oscillator: { type: musicParams.mood === 'sad' ? 'sine' : 'sawtooth' },\n        envelope: { attack: 0.1, decay: 0.5, sustain: 0.7, release: 1.5 },\n        volume: -8 + volumeBoost\n      }).toDestination();\n\n      const bass = new Tone.MonoSynth({\n        oscillator: { type: 'square' },\n        envelope: { attack: 0.1, decay: 0.6, sustain: 0.8, release: 2.0 },\n        volume: -12 + volumeBoost\n      }).toDestination();\n\n      const drums = {\n        kick: new Tone.MembraneSynth({ \n          pitchDecay: 0.05,\n          octaves: 10,\n          oscillator: { type: 'sine' },\n          envelope: { attack: 0.001, decay: 0.8, sustain: 0.01, release: 1.4 },\n          volume: -8 + volumeBoost\n        }).toDestination(),\n        snare: new Tone.NoiseSynth({ \n          noise: { type: 'white' },\n          envelope: { attack: 0.001, decay: 0.3, sustain: 0 },\n          volume: -12 + volumeBoost\n        }).toDestination(),\n        hihat: new Tone.MetalSynth({ \n          envelope: { attack: 0.001, decay: 0.1, sustain: 0 },\n          harmonicity: 5.1,\n          modulationIndex: 32,\n          resonance: 4000,\n          volume: -18 + volumeBoost\n        }).toDestination()\n      };\n\n      setGenerationStep('🎼 Generating chord progressions...');\n      setGenerationProgress(35);\n\n      // Generate musical elements based on interpretation\n      const scaleType = musicParams.mood === 'sad' ? 'minor' : \n                      musicParams.genre === 'blues' ? 'blues' : 'major';\n      const scaleNotes = getScale(musicParams.key, scaleType);\n      const progression = chordProgressions[musicParams.genre] || chordProgressions.pop;\n      const chords = generateChords(musicParams.key, progression);\n      \n      // Adjust melody complexity based on AI interpretation\n      const melodyLength = musicParams.complexity === 'simple' ? 16 : \n                          musicParams.complexity === 'complex' ? 48 : 32;\n      const melody = generateMelody(scaleNotes, melodyLength);\n      \n      if (!chords || chords.length === 0) {\n        throw new Error(`Failed to generate chords for ${musicParams.genre} in key ${musicParams.key}`);\n      }\n\n      setGenerationStep('🎚️ Creating sequences...');\n      setGenerationProgress(55);\n\n      Tone.Transport.bpm.value = musicParams.tempo;\n\n      // Create sequences with AI-influenced patterns\n      const chordSequence = new Tone.Sequence((time: number, chord: string[]) => {\n        if (chord && Array.isArray(chord) && chord.length >= 3) {\n          synth.triggerAttackRelease([`${chord[0]}3`, `${chord[1]}3`, `${chord[2]}3`], '2n', time);\n        }\n      }, chords, '2n');\n\n      const bassSequence = new Tone.Sequence((time: number, chord: string[]) => {\n        if (chord && Array.isArray(chord) && chord[0]) {\n          bass.triggerAttackRelease(`${chord[0]}2`, '4n', time);\n        }\n      }, chords, '4n');\n\n      const melodySequence = new Tone.Sequence((time: number, note: MelodyNote | null) => {\n        if (note && note.note && note.octave) {\n          synth.triggerAttackRelease(`${note.note}${note.octave}`, '8n', time);\n        }\n      }, melody, '8n');\n\n      // Drum patterns based on energy level\n      const drumIntensity = musicParams.energy === 'high' ? \n        { kick: ['0:0', '0:2', '1:0', '1:2', '2:0', '2:2', '3:0', '3:2'], snare: ['0:1', '1:1', '2:1', '3:1'] } :\n        musicParams.energy === 'low' ?\n        { kick: ['0:0', '2:0'], snare: ['1:0', '3:0'] } :\n        { kick: ['0:0', '1:0', '2:0', '3:0'], snare: ['1:0', '3:0'] };\n\n      const kickSequence = new Tone.Sequence((time: number) => {\n        drums.kick.triggerAttackRelease('C1', '8n', time);\n      }, drumIntensity.kick, '1n');\n\n      const snareSequence = new Tone.Sequence((time: number) => {\n        drums.snare.triggerAttack(time);\n      }, drumIntensity.snare, '1n');\n\n      const hihatSequence = new Tone.Sequence((time: number) => {\n        drums.hihat.triggerAttack(time);\n      }, ['0:0', '0:2', '1:0', '1:2', '2:0', '2:2', '3:0', '3:2'], '1n');\n\n      setGenerationStep('🎙️ Recording audio...');\n      setGenerationProgress(75);\n\n      // Start all sequences\n      chordSequence.start(0);\n      bassSequence.start(0);\n      melodySequence.start(0);\n      kickSequence.start(0);\n      snareSequence.start(0);\n      hihatSequence.start(0);\n\n      const recorder = new Tone.Recorder();\n      Tone.Destination.connect(recorder);\n      \n      await recorder.start();\n      Tone.Transport.start();\n\n      setGenerationStep('⏳ Processing audio output...');\n      setGenerationProgress(85);\n\n      const progressInterval = setInterval(() => {\n        setGenerationProgress(prev => Math.min(prev + 1, 95));\n      }, (duration * 1000) / 10);\n\n      setTimeout(async () => {\n        clearInterval(progressInterval);\n        setGenerationStep('💾 Finalizing track...');\n        setGenerationProgress(95);\n        \n        Tone.Transport.stop();\n        const recording = await recorder.stop();\n        \n        // Clean up\n        chordSequence.dispose();\n        bassSequence.dispose();\n        melodySequence.dispose();\n        kickSequence.dispose();\n        snareSequence.dispose();\n        hihatSequence.dispose();\n        \n        synth.dispose();\n        bass.dispose();\n        drums.kick.dispose();\n        drums.snare.dispose();\n        drums.hihat.dispose();\n        recorder.dispose();\n\n        if (recording.size === 0) {\n          throw new Error('Recording is empty - no audio was captured');\n        }\n\n        const url = URL.createObjectURL(recording);\n        const trackName = `${musicParams.mood.charAt(0).toUpperCase() + musicParams.mood.slice(1)} ${musicParams.genre} in ${musicParams.key}`;\n        \n        const newTrack: Track = {\n          id: Date.now().toString(),\n          name: trackName,\n          url: url,\n          type: 'generated',\n          prompt: generationPrompt,\n          genre: musicParams.genre,\n          tempo: musicParams.tempo,\n          key: musicParams.key,\n          duration: duration,\n          sampleReference: selectedSample?.title || null\n        };\n\n        setTracks(prev => [...prev, newTrack]);\n        setGenerationPrompt('');\n        setGenerationStep('✅ Generation complete!');\n        setGenerationProgress(100);\n        setCurrentCommand('Track generated successfully');\n        \n        setTimeout(() => {\n          setIsGenerating(false);\n          setGenerationProgress(0);\n          setGenerationStep('');\n          setCurrentCommand('Ready for next generation');\n        }, 2000);\n\n      }, duration * 1000);\n\n    } catch (error) {\n      console.error('❌ Generation failed:', error);\n      const errorMessage = error instanceof Error ? error.message : 'Unknown error occurred';\n      setGenerationError(`Failed to generate music: ${errorMessage}`);\n      setIsGenerating(false);\n      setGenerationProgress(0);\n      setGenerationStep('');\n      setCurrentCommand('Generation failed - ready to retry');\n    }\n  };\n\n  const handleFileUpload = async (event: React.ChangeEvent<HTMLInputElement>): Promise<void> => {\n    const file = event.target.files?.[0];\n    if (file && file.type.startsWith('audio/')) {\n      setConnectionError('');\n      try {\n        const url = URL.createObjectURL(file);\n        const newTrack: Track = {\n          id: Date.now().toString(),\n          name: file.name,\n          url: url,\n          type: 'uploaded',\n          duration: 0 // Will be set when audio loads\n        };\n        \n        setTracks(prev => [...prev, newTrack]);\n      } catch (error) {\n        console.error('Upload failed:', error);\n        setConnectionError('Failed to upload file. Please try again.');\n      }\n    } else {\n      setConnectionError('Please select a valid audio file.');\n    }\n  };\n\n  const playSample = (sample: Sample): void => {\n    console.log('🎵 Playing sample:', sample.title, 'URL:', sample.previewUrl);\n    \n    if (samplePlaying === sample.id) {\n      if (sampleAudioRef.current) {\n        sampleAudioRef.current.pause();\n        sampleAudioRef.current.currentTime = 0;\n      }\n      setSamplePlaying(null);\n      return;\n    }\n\n    if (!sampleAudioRef.current) {\n      console.error('❌ Sample audio ref not available');\n      return;\n    }\n\n    try {\n      sampleAudioRef.current.pause();\n      sampleAudioRef.current.currentTime = 0;\n      sampleAudioRef.current.volume = 0.7;\n      sampleAudioRef.current.crossOrigin = \"anonymous\";\n      \n      console.log('🔗 Setting audio source to:', sample.previewUrl);\n      sampleAudioRef.current.src = sample.previewUrl;\n      \n      const playPromise = sampleAudioRef.current.play();\n      \n      if (playPromise !== undefined) {\n        playPromise\n          .then(() => {\n            console.log('✅ Sample playing successfully');\n            setSamplePlaying(sample.id);\n          })\n          .catch(error => {\n            console.log('ℹ️ Sample URL blocked (expected due to CORS policy)');\n            console.log('💡 In a real app, samples would be hosted on the same domain');\n            setSamplePlaying(null);\n          });\n      }\n      \n    } catch (error) {\n      console.log('ℹ️ Sample playback blocked by browser policy');\n      setSamplePlaying(null);\n    }\n  };\n\n  const playTrack = (track: Track): void => {\n    if (currentTrack?.id === track.id && isPlaying) {\n      if (audioElementRef.current) {\n        audioElementRef.current.pause();\n        audioElementRef.current.currentTime = 0;\n      }\n      setIsPlaying(false);\n    } else {\n      if (audioElementRef.current) {\n        // Stop any playing track first\n        audioElementRef.current.pause();\n        audioElementRef.current.currentTime = 0;\n        \n        audioElementRef.current.src = track.url;\n        audioElementRef.current.play().catch(error => {\n          console.error('Error playing track:', error);\n          setIsPlaying(false);\n        });\n        setCurrentTrack(track);\n        setIsPlaying(true);\n      }\n    }\n  };\n\n  const downloadTrack = (track: Track): void => {\n    const link = document.createElement('a');\n    link.href = track.url;\n    link.download = `${track.name}.wav`;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  };\n\n  const deleteTrack = (trackId: string): void => {\n    const track = tracks.find(t => t.id === trackId);\n    if (track && track.url && track.url.startsWith('blob:')) {\n      URL.revokeObjectURL(track.url);\n    }\n    setTracks(prev => prev.filter(track => track.id !== trackId));\n    if (currentTrack?.id === trackId) {\n      setCurrentTrack(null);\n      setIsPlaying(false);\n    }\n  };\n\n  // Cleanup URLs when component unmounts\n  useEffect(() => {\n    return () => {\n      tracks.forEach(track => {\n        if (track.url && track.url.startsWith('blob:')) {\n          URL.revokeObjectURL(track.url);\n        }\n      });\n    };\n  }, [tracks]);\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 text-white\">\n      <div className=\"container mx-auto px-4 py-6\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between mb-8\">\n          <div className=\"flex items-center space-x-3\">\n            <Music className=\"w-8 h-8 text-purple-400\" />\n            <h1 className=\"text-3xl font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent\">\n              AI Music Creator\n            </h1>\n          </div>\n          <div className=\"flex items-center space-x-4\">\n            <input\n              type=\"text\"\n              value={projectName}\n              onChange={(e) => setProjectName(e.target.value)}\n              className=\"bg-white/10 border border-white/20 px-3 py-2 rounded-lg text-white placeholder-white/60\"\n              placeholder=\"Project Name\"\n            />\n          </div>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-6\">\n          {/* Sample Database */}\n          <div className=\"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20\">\n            <h2 className=\"text-xl font-semibold mb-4 flex items-center space-x-2\">\n              <Music className=\"w-5 h-5\" />\n              <span>Training Database</span>\n            </h2>\n            \n            <div className=\"space-y-4\">\n              {loadingSamples && (\n                <div className=\"text-center py-4\">\n                  <div className=\"text-sm text-white/60\">Loading royalty-free music database...</div>\n                  <div className=\"text-xs text-white/40 mt-1\">Kevin MacLeod collection</div>\n                </div>\n              )}\n              \n              <input\n                type=\"text\"\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                placeholder=\"Search samples...\"\n                className=\"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-white/60\"\n              />\n              \n              <div className=\"max-h-80 overflow-y-auto space-y-2\">\n                {filteredSamples.map(sample => (\n                  <div\n                    key={sample.id}\n                    onClick={() => setSelectedSample(sample)}\n                    className={`p-3 rounded-lg cursor-pointer transition-all ${\n                      selectedSample?.id === sample.id \n                        ? 'bg-purple-600/50 border border-purple-400' \n                        : 'bg-white/5 hover:bg-white/10 border border-white/10'\n                    }`}\n                  >\n                    <div className=\"text-sm font-medium\">{sample.title}</div>\n                    <div className=\"text-xs text-white/60\">{sample.artist}</div>\n                    <div className=\"flex items-center justify-between mt-1\">\n                      <span className=\"text-xs bg-white/20 px-2 py-1 rounded capitalize\">\n                        {sample.genre}\n                      </span>\n                      <div className=\"flex items-center space-x-2\">\n                        <span className=\"text-xs text-white/60\">\n                          {sample.tempo} BPM • {sample.key}\n                        </span>\n                        <button\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            playSample(sample);\n                          }}\n                          className=\"bg-blue-600 hover:bg-blue-700 p-1 rounded-full transition-colors\"\n                          title=\"Preview sample\"\n                        >\n                          {samplePlaying === sample.id ? (\n                            <Pause className=\"w-3 h-3\" />\n                          ) : (\n                            <Play className=\"w-3 h-3\" />\n                          )}\n                        </button>\n                      </div>\n                    </div>\n                    <div className=\"flex flex-wrap gap-1 mt-2\">\n                      {sample.tags.slice(0, 2).map(tag => (\n                        <span key={tag} className=\"text-xs bg-blue-500/30 px-1 py-0.5 rounded\">\n                          {tag}\n                        </span>\n                      ))}\n                    </div>\n                  </div>\n                ))}\n              </div>\n              \n              {selectedSample && (\n                <div className=\"bg-purple-500/20 border border-purple-400/50 rounded-lg p-3\">\n                  <div className=\"text-sm font-medium text-purple-200\">Selected Reference:</div>\n                  <div className=\"text-xs text-purple-300\">{selectedSample.title}</div>\n                  <div className=\"text-xs text-purple-400 mt-1\">\n                    Mood: {selectedSample.mood} • Style: {selectedSample.genre}\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Generation Panel */}\n          <div className=\"lg:col-span-2 space-y-6\">\n            {/* AI Generation */}\n            <div className=\"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20\">\n              <h2 className=\"text-xl font-semibold mb-4 flex items-center space-x-2\">\n                <Radio className=\"w-5 h-5\" />\n                <span>AI Music Generation</span>\n              </h2>\n              \n              {/* Status Window */}\n              <div className=\"bg-black/30 border border-white/20 rounded-lg p-3 mb-4 font-mono text-sm\">\n                <div className=\"flex items-center justify-between mb-1\">\n                  <span className=\"text-green-400\">Status:</span>\n                  <div className=\"flex items-center space-x-2\">\n                    <span className=\"text-white\">{connectionStatus}</span>\n                    {(connectionStatus.includes('❌') || connectionStatus.includes('Offline')) && (\n                      <button\n                        onClick={checkBackendConnection}\n                        disabled={isCheckingConnection}\n                        className=\"bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed px-2 py-1 rounded text-xs transition-colors\"\n                        title=\"Retry backend connection\"\n                      >\n                        {isCheckingConnection ? '🔄' : '🔄 Retry'}\n                      </button>\n                    )}\n                  </div>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-blue-400\">Command:</span>\n                  <span className=\"text-white\">{currentCommand}</span>\n                </div>\n                {generationStep && (\n                  <div className=\"flex items-center justify-between mt-1\">\n                    <span className=\"text-yellow-400\">Process:</span>\n                    <span className=\"text-white\">{generationStep}</span>\n                  </div>\n                )}\n              </div>\n              \n              <div className=\"space-y-4\">\n                <textarea\n                  value={generationPrompt}\n                  onChange={(e) => setGenerationPrompt(e.target.value)}\n                  placeholder=\"Describe the music you want to create... (e.g., 'upbeat pop song with guitar and drums, happy mood')\"\n                  className=\"w-full h-24 bg-white/10 border border-white/20 rounded-lg px-4 py-3 text-white placeholder-white/60 resize-none\"\n                />\n                \n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium mb-2\">Genre</label>\n                    <select\n                      value={selectedGenre}\n                      onChange={(e) => setSelectedGenre(e.target.value)}\n                      className=\"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white\"\n                    >\n                      {genres.map(genre => (\n                        <option key={genre} value={genre} className=\"bg-gray-800\">\n                          {genre.charAt(0).toUpperCase() + genre.slice(1)}\n                        </option>\n                      ))}\n                    </select>\n                  </div>\n                  \n                  <div>\n                    <label className=\"block text-sm font-medium mb-2\">Tempo (BPM)</label>\n                    <input\n                      type=\"range\"\n                      min=\"60\"\n                      max=\"200\"\n                      value={tempo}\n                      onChange={(e) => setTempo(Number(e.target.value))}\n                      className=\"w-full\"\n                    />\n                    <div className=\"text-center text-sm text-white/70\">{tempo}</div>\n                  </div>\n                  \n                  <div>\n                    <label className=\"block text-sm font-medium mb-2\">Key</label>\n                    <select\n                      value={key}\n                      onChange={(e) => setKey(e.target.value)}\n                      className=\"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white\"\n                    >\n                      {keys.map(k => (\n                        <option key={k} value={k} className=\"bg-gray-800\">{k}</option>\n                      ))}\n                    </select>\n                  </div>\n\n                  <div>\n                    <label className=\"block text-sm font-medium mb-2\">Duration (s)</label>\n                    <input\n                      type=\"range\"\n                      min=\"10\"\n                      max=\"120\"\n                      value={duration}\n                      onChange={(e) => setDuration(Number(e.target.value))}\n                      className=\"w-full\"\n                    />\n                    <div className=\"text-center text-sm text-white/70\">{duration}s</div>\n                  </div>\n                </div>\n                \n                <button\n                  onClick={generateMusic}\n                  disabled={isGenerating}\n                  className=\"w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 disabled:opacity-50 disabled:cursor-not-allowed px-6 py-3 rounded-lg font-semibold transition-all duration-200\"\n                >\n                  {isGenerating ? `Generating Music... ${generationProgress}%` : 'Generate Music'}\n                </button>\n\n                {/* Progress Bar */}\n                {isGenerating && (\n                  <div className=\"w-full bg-white/20 rounded-full h-2\">\n                    <div \n                      className=\"bg-gradient-to-r from-purple-400 to-pink-400 h-2 rounded-full transition-all duration-300\"\n                      style={{ width: `${generationProgress}%` }}\n                    ></div>\n                  </div>\n                )}\n\n                {/* Error Messages */}\n                {generationError && (\n                  <div className=\"bg-red-500/20 border border-red-500/50 rounded-lg p-3 text-red-200\">\n                    <div className=\"flex items-center space-x-2\">\n                      <span className=\"text-red-400\">⚠️</span>\n                      <span>{generationError}</span>\n                    </div>\n                    <button \n                      onClick={() => setGenerationError('')}\n                      className=\"text-red-400 hover:text-red-300 text-sm mt-1\"\n                    >\n                      Dismiss\n                    </button>\n                  </div>\n                )}\n\n                {connectionError && (\n                  <div className=\"bg-orange-500/20 border border-orange-500/50 rounded-lg p-3 text-orange-200\">\n                    <div className=\"flex items-center space-x-2\">\n                      <span className=\"text-orange-400\">⚠️</span>\n                      <span>{connectionError}</span>\n                    </div>\n                    <button \n                      onClick={() => setConnectionError('')}\n                      className=\"text-orange-400 hover:text-orange-300 text-sm mt-1\"\n                    >\n                      Dismiss\n                    </button>\n                  </div>\n                )}\n              </div>\n            </div>\n\n            {/* Upload */}\n            <div className=\"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20\">\n              <h2 className=\"text-xl font-semibold mb-4 flex items-center space-x-2\">\n                <Upload className=\"w-5 h-5\" />\n                <span>Upload Audio</span>\n              </h2>\n              \n              <label className=\"w-full bg-indigo-600 hover:bg-indigo-700 px-4 py-3 rounded-lg flex items-center justify-center space-x-2 cursor-pointer transition-colors\">\n                <Upload className=\"w-4 h-4\" />\n                <span>Upload Audio File</span>\n                <input\n                  type=\"file\"\n                  accept=\"audio/*\"\n                  onChange={handleFileUpload}\n                  className=\"hidden\"\n                />\n              </label>\n            </div>\n          </div>\n\n          {/* Track List */}\n          <div className=\"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20\">\n            <h2 className=\"text-xl font-semibold mb-4 flex items-center space-x-2\">\n              <Volume2 className=\"w-5 h-5\" />\n              <span>Tracks ({tracks.length})</span>\n            </h2>\n            \n            <div className=\"space-y-3 max-h-96 overflow-y-auto\">\n              {tracks.map(track => (\n                <div\n                  key={track.id}\n                  className={`bg-white/10 rounded-lg p-4 border ${\n                    currentTrack?.id === track.id ? 'border-purple-400' : 'border-white/20'\n                  }`}\n                >\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <h3 className=\"font-medium truncate flex-1\">{track.name}</h3>\n                    <div className=\"flex space-x-1\">\n                      <button\n                        onClick={() => downloadTrack(track)}\n                        className=\"text-green-400 hover:text-green-300\"\n                        title=\"Download\"\n                      >\n                        <Download className=\"w-4 h-4\" />\n                      </button>\n                      <button\n                        onClick={() => deleteTrack(track.id)}\n                        className=\"text-red-400 hover:text-red-300\"\n                        title=\"Delete\"\n                      >\n                        <Trash2 className=\"w-4 h-4\" />\n                      </button>\n                    </div>\n                  </div>\n                  \n                  {track.type === 'generated' && (\n                    <div className=\"text-xs text-white/60 mb-2\">\n                      {track.genre} • {track.key} • {track.tempo} BPM\n                      {track.sampleReference && (\n                        <span className=\"ml-1\">• Ref: {track.sampleReference}</span>\n                      )}\n                    </div>\n                  )}\n                  \n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-xs text-white/60 capitalize\">{track.type}</span>\n                    <button\n                      onClick={() => playTrack(track)}\n                      className=\"bg-purple-600 hover:bg-purple-700 p-2 rounded-full transition-colors\"\n                    >\n                      {currentTrack?.id === track.id && isPlaying ? (\n                        <Pause className=\"w-4 h-4\" />\n                      ) : (\n                        <Play className=\"w-4 h-4\" />\n                      )}\n                    </button>\n                  </div>\n                </div>\n              ))}\n              \n              {tracks.length === 0 && (\n                <div className=\"text-center py-8 text-white/60\">\n                  <Music className=\"w-12 h-12 mx-auto mb-3 opacity-50\" />\n                  <p>No tracks yet. Generate or upload some music!</p>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      <audio\n        ref={audioElementRef}\n        onEnded={() => setIsPlaying(false)}\n        onPause={() => setIsPlaying(false)}\n        onError={(e) => {\n          console.error('Audio error:', e);\n          setIsPlaying(false);\n        }}\n      />\n      \n      <audio\n        ref={sampleAudioRef}\n        onEnded={() => setSamplePlaying(null)}\n        onPause={() => setSamplePlaying(null)}\n        onError={(e) => {\n          console.error('Sample audio error:', e);\n          setSamplePlaying(null);\n        }}\n      />\n    </div>\n  );\n};\n\nexport default AIMusicsCreator;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}